---
title: 超平面、函数间隔和几何间隔
tags:
  - 超平面
  - 函数间隔
  - 几何间隔
  - SVM
categories:
  - MachineLearning
comments: true
mathjax: true
date: 2019-10-20 20:24:35
urlname: hyperplane-functionalmargin-geometricmargin
---

<meta name="referrer" content="no-referrer" />

{% note info %}
关于超平面、函数间隔以及几何间隔的理解。
这些在SVM中要用到。
{% endnote %}
<!--more-->

## 超平面
### 定义
1. 超平面是指n维线性空间中维度为n-1的子空间。它可以把线性空间分割成不相交的两部分。比如二维空间中，一条直线是一维的，它把平面分成了两块；三维空间中，一个平面是二维的，它把空间分成了两块。
2. 法向量是指垂直于超平面的向量

### 法向量和超平面公式
假设在$$R^3$$空间内，那么法向量和平面总是垂直的。如下图：

![三维空间中法向量和平面横截面](https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/blog/YmaoZU.png)

$$ x(x_1', x_2, x_3) $$
$$ x(x_1, x_2, x_3)，x'(x_1', x_2', x_3')，w(w_1, w_2, w_3) $$

不难看出，$$x - x'$$和法向量垂直，于是：
$$(x-x')w = 0$$
$$(x_1-x_1', x_2-x_2', x_3-x_3') · (w_1, w_2, w_3) = 0$$
化简后得：
$$x_1w_1 + x_2w_2 + x_3w_3 = w_1x_1' + w_2x_2' + w_3x_3'$$
由于其为常数项，所以令：
$$b = -w^Tx'$$
于是超平面公式可以写成:
$$w^Tx+b = 0$$
同样可以推导到$$R^n$$空间

### 点到超平面距离

![点到超平面距离](https://cdn.jsdelivr.net/gh/HanielF/ImageRepo@main/blog/TcoELs.png)

x是平面外一点，距离平面是d，即红色线。
通过三角函数得到：
$$ cos{\theta}=\dfrac{d}{||x-x'||} $$
又因为d和法向量平行，所以可以通过向量相乘等于模乘模乘cos得到：
$$ |(x-x')\omega|=||x-x'||\cdot||\omega||\cdot\cos{\theta} $$
联立得到：
$$ d = \dfrac{|(x-x')\omega|}{||\omega||}=\dfrac{|\omega x-\omega x'|}{||\omega||} $$
因为$$  x' $$在超平面内，$$ \omega x'=-b $$，于是最后得到的任意点到超平面的距离公式：
$$ d=\dfrac{|\omega x+b|}{||\omega||} $$

其实高中学过一点$$ x_i, y_i $$到直线$$  ax+by+c=0 $$的距离公式：
$$  d(x_i, y_i) = {|ax_i+by_i+c| \over \sqrt{a^2+b^2}}$$
这个和上面通用的公式可以对应

## 函数间隔
在超平面确定的情况下，点到平面距离公式中，分母不变，所以分子$$|\omega·x + b|$$可以近似表示点到超平面的距离。

如果$$ \omega · x + b > 0 $$，则被认为是正类，否则为负类
如果都正确分类，那么$$  y(\omega ·x +b) > 0 $$，如果分类错误，那么小于0.
同时，$$  y(\omega ·x +b) > 0 $$的绝对值越大，则确信度越大

因此用这个来表示函数间隔。对于一个训练样本(x(i),y(i))我们定义它到超平面(w,b)的函数间隔为:
$$\hatγ = y^{(i)}(w^Tx^{(i)}+b)$$ 

函数间隔越大越好，并且如果$$ \hatγ > 0 $$，则样本正确分类
对于整个训练集，定义函数间隔为所有样本中最小的那个函数间隔:
$$ \hatγ = min_i \hatγ^{(i)}$$

## 几何间隔
对于函数间隔，有个问题就是，可以在不改变超平面的情况下，让函数间隔任意大。
如果$$ \omega $$和$$  b $$倍增，函数间隔改变，但是超平面不变。

因此我们对函数间隔加上一个限制：
$$ ||\omega|| = 1 $$

这样是为了，让$$ \omega和b $$倍增的时候，分母也会倍增，所以几何间隔就不会改变。
当$$  ||\omega||=1 $$的时候，几何间隔就是函数间隔

所以几何间隔的公式就是：
$$ γ^{(i)} = y^{(i)}({w^T \over ∥w∥}x^{(i)}+{b \over ∥w∥}) $$

训练集的集合间隔是所有样本中最小的那个：
$$ γ = min_iγ^{(i)}$$

有没有发现，几何间隔其实就是**点到平面的距离**

函数间隔和几何间隔的关系：
$$  γ^{(i)}={\hatγ^{(i)} \over ∥w∥ }$$

